<!DOCTYPE html>
<html>

    <head>
        <script>
            // Inline script to apply theme before the page renders
            (function() {
              const savedTheme = localStorage.getItem('theme');
              if (savedTheme) {
                document.documentElement.className = savedTheme;
              }
            })();
        </script>
        
        <meta charset="utf-8">
        <meta content="width=device-width, initial-scale=1" name="viewport">
        <link rel="stylesheet" href="/assets/css/main.css">

        <h1 class="post-headline">Luca Pantea</h1>
        <h3 class="post-description">MSc Student in Artificial Intelligence &nbsp; <img src='https://cdn.freebiesupply.com/logos/large/2x/amsterdam-38-logo-png-transparent.png' alt='University Logo' style='max-width: 20px; height: 20px;'> &nbsp; University of Amsterdam</h3>

        <div class="links scroll">
        <link rel="stylesheet" href="/assets/css/main.css">
        <a href="/">Home</a>
        <a href="/projects/">Projects</a>
        <!-- <a href="/blog/">Blog</a> -->
        <a href="/resume/">R√©sum√©</a>
        <!-- <a href="/Luca_Pantea_CV_2_0.pdf">R√©sum√©</a> -->
        <div id="theme-switcher" class="theme-switcher">
                <i class="fas fa-sun" id="theme-icon"></i>
        </div>  

        <script>
          const themeSwitcher = document.getElementById('theme-switcher');
          const themeIcon = document.getElementById('theme-icon');
          const body = document.body;

          // Function to toggle the theme
          function toggleTheme() {
            if (body.classList.contains('dark-theme')) {
              body.classList.remove('dark-theme');
              body.classList.add('light-theme');
              localStorage.setItem('theme', 'light'); // Save theme to localStorage
              themeIcon.classList.remove('fa-sun');
              themeIcon.classList.add('fa-moon');
            } else {
              body.classList.remove('light-theme');
              body.classList.add('dark-theme');
              localStorage.setItem('theme', 'dark'); // Save theme to localStorage
              themeIcon.classList.remove('fa-moon');
              themeIcon.classList.add('fa-sun');
            }
          }

          // Function to apply the saved theme or default to light
          function applyTheme() {
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme === 'dark') {
              body.classList.add('dark-theme');
              themeIcon.classList.remove('fa-moon');
              themeIcon.classList.add('fa-sun');
            } else {
              // Default to light theme
              body.classList.add('light-theme');
              themeIcon.classList.remove('fa-sun');
              themeIcon.classList.add('fa-moon');
            }
          }

          // Set initial theme based on saved preference or default
          applyTheme();

          // Listener for the theme switcher
          themeSwitcher.addEventListener('click', toggleTheme);
        </script>
              
</div>


        <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Fairness-Enhanced Representational Learning | Luca Pantea</title>
<meta name="generator" content="Jekyll v4.2.2" />
<meta property="og:title" content="Fairness-Enhanced Representational Learning" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Introducing SoftWalk. Significantly improving fairness and node representational quality." />
<meta property="og:description" content="Introducing SoftWalk. Significantly improving fairness and node representational quality." />
<link rel="canonical" href="https://lucapantea.github.io/projects/2-softwalk/" />
<meta property="og:url" content="https://lucapantea.github.io/projects/2-softwalk/" />
<meta property="og:site_name" content="Luca Pantea" />
<meta property="og:image" content="https://lucapantea.github.io/assets/images/thumbnail-0.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2024-02-25T15:06:44+00:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="https://lucapantea.github.io/assets/images/thumbnail-0.png" />
<meta property="twitter:title" content="Fairness-Enhanced Representational Learning" />
<meta name="twitter:site" content="@" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2024-02-25T15:06:44+00:00","datePublished":"2024-02-25T15:06:44+00:00","description":"Introducing SoftWalk. Significantly improving fairness and node representational quality.","headline":"Fairness-Enhanced Representational Learning","image":"https://lucapantea.github.io/assets/images/thumbnail-0.png","mainEntityOfPage":{"@type":"WebPage","@id":"https://lucapantea.github.io/projects/2-softwalk/"},"url":"https://lucapantea.github.io/projects/2-softwalk/"}</script>
<!-- End Jekyll SEO tag -->


        <!-- Generated using https://favicon.io/ -->
<link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png?">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png?">
<link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png?">
<link rel="manifest" href=site.webmanifest">


        <!-- MathJax -->
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML">
  </script>

  <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: { inlineMath: [ ['$','$'], ["\\(","\\)"] ],
     processEscapes: true
    }
  });
</script>


        <!-- Load fontawesome here for faster loadtimes: https://stackoverflow.com/a/35880730/9523246 -->
        <script type="text/javascript"> (function() { var css = document.createElement('link'); css.href = 'https://use.fontawesome.com/releases/v5.11.0/css/all.css'; css.rel = 'stylesheet'; css.type = 'text/css'; document.getElementsByTagName('head')[0].appendChild(css); })(); </script>
    </head>

    <body>

        <main>
            <article>
                <h1 class="post-headline">Fairness-Enhanced Representational Learning</h1>
<p class="meta"><small>February 25, 2024</small></p>

<blockquote>
  <p>The work was accepted for the 2022 Machine Learning Reproducibility Challenge and published in ReScience C journal and was awarded a $10,000 grant from Kaggle.
<strong>Paper links</strong>: <a href="https://openreview.net/forum?id=tpk45Zll8eh" target="_blank" rel="noopener noreferrer">OpenReview</a> | <a href="https://www.kaggle.com/code/lucapantea1/reproducibility-study-of-crosswalk" target="_blank" rel="noopener noreferrer">Kaggle</a> | <a href="https://github.com/Dawlau/FACT-AI" target="_blank" rel="noopener noreferrer">GitHub</a></p>
</blockquote>

<p><img src="/assets/images/FACT.png" alt="Header Image"></p>

<p>Recently, alongside <a href="https://github.com/Dawlau" target="_blank" rel="noopener noreferrer">Andrei</a>, I ventured into the realm of fairness in machine learning by getting our hands dirty with reproducing ‚ÄúCrossWalk: Fairness-enhanced Node Representation Learning.‚Äù (<a href="https://arxiv.org/abs/2105.02725" target="_blank" rel="noopener noreferrer">paper link</a>). The potential for machine learning systems to amplify social inequities and unfairness is receiving increasing popular and academic attention. However, there is little work enhancing fairness in graph algorithms. Even less in reproducing these algorithms, and verifying their claims‚Ä¶</p>

<p>Our starting point was the CrossWalk repository that the original authors were kind enough to share. Step $0$ to $1$ was done. However, $1$ to $n$ was a whole different story. The lack of documentation and some missing logic meant we had to roll up our sleeves and re-code from scratch. We packaged all our hard work into a neat Python package, so anyone could easily replicate the results and join in on the fun (here‚Äôs the <a href="https://github.com/Dawlau/FACT-AI" target="_blank" rel="noopener noreferrer">repo link</a>).</p>

<p>This is what we managed to do in a month‚Äôs time:</p>

<ul>
  <li>
<span style="color: #79ba8d;font-weight:900">[Reproducibility Study]</span> Reproducing the results from the original paper: We were
able to partially reproduce the claim that Crosswalk enhances fairness, namely for
the tasks of node classification and influence maximization. The second claim,
which is that the proposed method preserves the higher‚Äêorder proximity of the
graph was successfully reproduced.</li>
  <li>
<span style="color: #79ba8d;font-weight:900">[Extended Work]</span> Improvement of the original code: The original code is not easily runnable, so we had to refactor it and implement our own Bash and Python
scripts such that the experiments can be more easily reproduced. Further, we provide a master Python script that allows for the reproducibility of the experiments
presented in this report by running only a single terminal command.</li>
  <li>
<span style="color: #79ba8d;font-weight:900">[Extended Work]</span> Ablation study: CrossWalk does not usually yield the expected
results out of the box, but by carefully picking the right hyperparameters we managed to make CrossWalk behave as presented in the original paper.</li>
  <li>
<span style="color: #79ba8d;font-weight:900">[Extended Work]</span> CrossWalk visualization: We perform additional visualizations
of the edge reweighting procedure and random walk trajectories to investigate the
claims proposed by the original authors.</li>
  <li>
<span style="color: #79ba8d;font-weight:900">[Proposed Enhancement]</span> Soft Self‚ÄêAvoiding CrossWalk: We propose an extension
to the algorithm proposed by Khajehnejad et al. which yields better node representations and higher fairness.</li>
</ul>

<p>Quite a bit :) let‚Äôs dive into it.</p>

<h3 id="the-original-models-inner-workings">The Original Model‚Äôs Inner workings</h3>
<p><span style="color: #79ba8d;font-weight:900">CrossWalk</span> is a re-weighting method that is used to bias random walk-based algorithms towards visiting multiple groups, which in turn enhances fairness. This is mainly done by re-weighting the probabilities associated with the graph edges as follows:</p>

<ul>
  <li>CrossWalk increases the weights of edges <span style="color: #79ba8d;font-weight:900">near the group boundaries</span>.</li>
  <li>CrossWalk increases the weights of edges <span style="color: #79ba8d;font-weight:900">that connect nodes from different groups</span>.</li>
</ul>

<p>The mathematical formulas that describe the re-weightings from points 1 and 2 are the following:</p>

\[\begin{equation}
w_{vu}^{'} = \begin{cases} w_{vu}(1-\alpha) \times \frac{m(u)^p}{\sum\limits_{z \in N_v} w_{vz}m(z)^p} &amp; \text{if } u \in N(v), l_v = l_u \\
w_{vu}\alpha \times \frac{m(u)^p}{|R_{v}| \times \sum\limits_{z \in N_{v}^c} w_{vz}m(z)^p} &amp; \text{if } u \in N(v), l_v \neq l_u = c.\end{cases}
\end{equation}\]

<p>where $w_{vu}$ is the initial weight of the edge $(u,v)$, $\alpha$ and $p$ are hyperparameters, $R_{v}$ the set of groups in the neighbourhood of $v$, $l_{x}$ the group that node $x$ is part of, and $m(z)$ is the proximity of a node as described in the original paper.</p>

<p>Cool üéâ. However, upon further in-depth study, we realised that this re-weighting caused some subtle, yet impactful issues.</p>

<p>In a nutshell, this re-weighting mechanism caused the random walks to <span style="color: #79ba8d;font-weight:900">travel back and forth between edges localted at group peripherals, esentially getting stuck in a loop</span>. This is because the re-weighting mechanism is not self-avoiding, meaning that the random walks can visit the same edge multiple times. This is a problem because the random walks are supposed to be unbiased, and the re-weighting mechanism biases these trajectories in an undesirable way.</p>

<p>Through sampling and visually analyzing trajectories, we explored CrossWalk‚Äôs mechanics. The image at the beginning the page compares edge weights and a trajectory between a random walk algorithm without and with CrossWalk‚Äôs re-weighting. Lighter edges indicate higher edge weights, different node colors represent distinct groups, and a bolded blue line traces a sampled random walk trajectory. CrossWalk on the right visits fewer new nodes compared to the un-reweighted algorithm on the left, as the re-weighting mechanism leads the random walk into a repetitive loop, revisiting the same edges.</p>

<p>As a result, <u>the structural properties of the graph are not fully utilized</u>, leading to decreased representation quality.</p>

<h3 id="our-enhancement">Our Enhancement!</h3>

<p>We propose a solution based on Self‚ÄêAvoiding Walks  which steers the random walks towards avoiding previously visited edges by using a discounting function, parameterized by $\gamma$:</p>

\[\begin{equation}
P(u_i = u \lvert u_{i-1} = v) = \left\{
        \begin{array}{ll}
            \pi_{uv} \cdot \gamma^{c(u,v)}  &amp; \quad \text{if} \ (u, v) \in E \\
            0 &amp; \quad \text{otherwise}
        \end{array}
    \right.
\end{equation}\]

<p>Where $c(u, \ v)$ stores the number of times the walk has traversed the edge between node $u$ and $v$. As $\gamma \in [0, \ 1]$, if $\gamma \rightarrow 1$, the behaviour is similar to CrossWalk, while $\gamma \rightarrow 0$ stimulates the random walk to avoid already visited edges. $\pi_{uv}$ represents probability of selecting the edge $(u, \ v)$, weighted by the modifed edge weights of CrossWalk, as expressed above. We call this method <span style="color: #79ba8d;font-weight:900">SoftWalk</span>.</p>

<p>Our implementation uses a HashMap initialized per random walk for storing the counts of the previously visited edges, which has a worst-case time and space complexity of $\mathcal{O}(K)$, where $K$ represents the preset random walk length. Thus, our proposed method scales with $K$, which <span style="color: #79ba8d;font-weight:900">supports scalability</span>, as $K$ $¬´$ $\lvert E\lvert$, where $E$ is the set of graph edges for a given graph.</p>

<h3 id="our-results-and-a-bit-of-discussion">Our Results and a Bit of Discussion</h3>

<p>The results indicate that the proposed extension <span style="color: #79ba8d;font-weight:900">consistently outperforms</span> the original implementation of CrossWalk on the two reproducible tasks - Link Prediction and Node Classification. <span style="color: #79ba8d;font-weight:900">Softwalk not only achieves better accuracy and influence percentage</span> but <span style="color: #79ba8d;font-weight:900">additionally minimizes the disparity</span> (thus maximizing fairness) for each task. Check <a href="https://openreview.net/forum?id=tpk45Zll8eh" target="_blank" rel="noopener noreferrer">our paper</a> to see the numbers and plots!</p>

<h3 id="limitations">Limitations</h3>

<p>Our contributions suffer from three main drawbacks. First, due to time constraints, we were unable to resolve the outstanding issues regarding link predictions, yet we were able to obtain results that follow the same trends for the other tasks. Second, the re-implementation of the original base significantly decelerated the reproduction process. And finally, the proposed approach is independent of the underlying graph characteristics, which encourages future work in the direction of estimating $\gamma$ via a non-linear function approximation (i.e. neural network-based approaches).</p>

<p><br></p>

<hr>
<p>If you made it this far, I hope you enjoyed the read and learned something new! If you have any questions, feel free to reach out to me on <a href="https://twitter.com/luca_pantea" target="_blank" rel="noopener noreferrer">Twitter</a> or <a href="https://www.linkedin.com/in/luca-pantea/" target="_blank" rel="noopener noreferrer">LinkedIn</a>. I‚Äôd love to hear your thoughts! üòä</p>


<!-- Comments only for posts -->


            </article>
        </main>

        <footer>
          <p class="copy">
            <small> ¬© Luca Pantea 2024
                    | Powered by Jekyll and
                    <a target="_blank" href="https://github.com/jitinnair1/gradfolio/" rel="noopener noreferrer">Gradfolio</a>.
                    Last updated on 25 February 2024
            </small>
          </p>

        <div class="rounded-social-buttons">
<a title="" class="social-button email" itemprop="email" href="mailto:%6C%75%63%61.%70.%70%61%6E%74%65%61@%67%6D%61%69%6C.%63%6F%6D" target="_blank">
<i class="far fa-envelope"></i>
</a><a title="" class="social-button linkedin" href="https://www.linkedin.com/in/lucapantea" itemprop="sameAs" target="_blank" rel="noopener noreferrer">
<i class="fab fa-linkedin"></i>
</a><a title="" class="social-button github" href="https://www.github.com/lucapantea" itemprop="sameAs" target="_blank" rel="noopener noreferrer">
<i class="fab fa-github"></i>
</a><a title="" class="social-button twitter" href="https://www.twitter.com/luca_pantea" itemprop="sameAs" target="_blank" rel="noopener noreferrer">
<i class="fab fa-twitter"></i>
</a>
</div>


        </footer>

        <!-- Google Analytics Tracking code -->
<script src="https://cdn.jsdelivr.net/npm/ga-lite@1/dist/ga-lite.min.js" async></script>
<script>
var galite = galite || {};
galite.UA = '';
</script>

    </body>

</html>
